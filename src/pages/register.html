<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/register.css">
</head>
<body>
<header class="bx">
    <div class="left"></div>
    <div class="right"></div>
</header>
<div class="wrap ">
    <div class="bx">
        <div class="content">
            <h1>会员注册</h1>
            <input type="text" username="username" placeholder="请输入您注册的用户名" id="username">
            <span class="span1"> 帐号是否合法(字母开头，允许6-10个字符，允许字母数字下划线)</span>
            <br>
            <input type="password" username="password" placeholder="请输入您注册的密码" id="password">
            <span class="span2">密码格式不对,以字母开头，长度在6~10之间，只能包含字母、数字和下划线</span>
            <br>
            <input type="password" placeholder="请再次输入您注册的密码" class="mima">
            <span class="span3">两次密码输入不一致</span>
            <div class="btn">立即注册</div>

        </div>
    </div>
</div>
<div class="footer bx">
    <div class="footer-c">
        <p>Copyright 2008-2020 vip.com，All Rights Reserved ICP证：粤 B2-20080329</p>
    </div>
</div>
<script>
    $(function () {

        var falg1 = false;
        $('#username').change(function () {
            let val = $(this).val();
            if (/^[a-zA-Z][a-zA-Z0-9_]{5,9}$/.test(val)) {
                $('.span1').hide();
                falg1 = true;
            } else {
                $('.span1').show();
                falg1 = false;
            }
        })

        var falg2 = false;
        $('#password').change(function () {
            let val = $(this).val();
            if (/^[a-zA-Z]\w{5,9}$/.test(val)) {
                $('.span2').hide();
                falg2 = true;
            } else {
                $('.span2').show();
                falg2 = false;
            }
        })

        var falg3 = false;
        $('.mima').change(function () {
            let val = $(this).val();
            if (val === $('#password').val()) {
                $('.span3').hide();
                falg3 = true;
            } else {
                $('.span3').show();
                falg3 = false;
            }
        })


        $('.btn').click(function () {
            if (falg1 && falg2 && falg3) {
                $.ajax({
                    url: '../php/register.php',
                    type: 'post',
                    data: `username=${$('#username').val()}&password=${$('#password').val()}`,
                    dataType: 'json',
                    success: function (res) {
                        if (res === 1) {
                            location.href = './login.html';
                        } else {
                            alert('用户名已存在');
                        }
                    }
                })
            }

        })
        $('.btn').mousedown(function () {
            $(this).css({
                opacity: .3
            })
        })
        $('.btn').mouseup(function () {
            $(this).css({
                opacity: 1
            })
        })
    })
</script>
</body>
</html>